script-dir: /etc/nodepool/scripts
dburi: 'mysql+pymysql://nodepool:<%= @nodepool_sql_password %>@<%= @nodepool_mysql_address %>/nodepool'

zmq-publishers:
 - tcp://<%= @jenkins_host %>:8888

gearman-servers:
 - host: 127.0.0.1

cron:
  image-update: '14 2 * * *'
  cleanup: '27 */6 * * *'
  check: '*/15 * * * *'

targets:
  - name: jenkins
    jenkins:
      url: '<%= @url["jenkins_jjb_url"] %>'
      user: 'jenkins'
      apikey: '<%= @jenkins_password %>'
      credentials-id: '4f98191e-efbb-4ac4-8131-0e4a8bb2ce14'

providers:
<% @nodepool['providers'].each do | provider | -%>
  - name: <%= provider['name'] %>
<% if provider['auth-url'] -%>
    auth-url: <%= provider['auth-url'] %>
<% end -%>
<% if provider['project-id'] -%>
    project-id: <%= provider['project-id'] %>
<% end -%>
<% if provider['username'] -%>
    username: <%= provider['username'] %>
<% end -%>
<% if provider['password'] -%>
    password: <%= provider['password'] %>
<% end -%>
<% if provider['pool'] -%>
    pool: <%= provider['pool'] %>
<% end -%>
<% if provider['max-servers'] -%>
    max-servers: <%= provider['max-servers'] %>
<% end -%>
<% if provider['rate'] -%>
    rate: <%= provider['rate'] %>
<% end -%>
<% if provider['boot-timeout'] -%>
    boot-timeout: <%= provider['boot-timeout'] %>
<% end -%>
<% end -%>
